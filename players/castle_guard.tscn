[gd_scene load_steps=90 format=3 uid="uid://db6ymfwleb2le"]

[ext_resource type="Script" uid="uid://bk4xmmrhr0cj5" path="res://scripts/players/player.gd" id="1_xdeuw"]
[ext_resource type="Script" uid="uid://dvvkgt736bhn3" path="res://scripts/players/player_components/camera_controller.gd" id="2_38c5k"]
[ext_resource type="Script" uid="uid://c47rutq7bsxpd" path="res://scripts/players/player_components/screen_effects_manager.gd" id="3_8g3xg"]
[ext_resource type="PackedScene" uid="uid://ds18ha47u5may" path="res://assets/castle_guard_blender_files/castle_guard_rig.glb" id="3_eenxj"]
[ext_resource type="PackedScene" uid="uid://timl11fn7e7r" path="res://components/hitbox.tscn" id="4_8g3xg"]
[ext_resource type="PackedScene" uid="uid://bpr8g3r0ix54i" path="res://assets/FreeWeapons/Meshes/Sword00_mesh.FBX" id="4_pjw5s"]
[ext_resource type="Script" uid="uid://ldf4sgx7md2t" path="res://scripts/components/state_machine.gd" id="6_gr1yf"]
[ext_resource type="Script" uid="uid://x75apcnqjl2" path="res://scripts/players/player_states/locomotion_states/walk.gd" id="7_3lvfj"]
[ext_resource type="PackedScene" uid="uid://cvkbnyv7la4r1" path="res://assets/FreeWeapons/Meshes/Shield00_mesh.FBX" id="7_8g3xg"]
[ext_resource type="Script" uid="uid://blvbyxh5ud4g0" path="res://scripts/players/player_states/locomotion_states/sprint.gd" id="8_r05bu"]
[ext_resource type="Script" uid="uid://1oyh5gx0tru5" path="res://scripts/players/player_states/locomotion_states/idle.gd" id="9_gku8k"]
[ext_resource type="Script" uid="uid://bikhvdq18ss26" path="res://scripts/players/player_states/locomotion_states/jump.gd" id="10_2sjqy"]
[ext_resource type="Script" uid="uid://b011l7nwbtjp5" path="res://scripts/players/player_states/locomotion_states/fall.gd" id="11_36l6j"]
[ext_resource type="Script" uid="uid://ba8s637itq84" path="res://scripts/players/player_states/combat_states/not_attacking.gd" id="12_ulow1"]
[ext_resource type="Script" uid="uid://mjbfiearrapg" path="res://scripts/players/player_states/combat_states/attack_1.gd" id="13_51p4a"]
[ext_resource type="Script" uid="uid://ds5pgpcim42dg" path="res://scripts/players/player_states/combat_states/attack_2.gd" id="14_kolhv"]
[ext_resource type="Script" uid="uid://dve76yn62fbds" path="res://scripts/players/player_states/locomotion_states/evade.gd" id="15_15rro"]
[ext_resource type="Script" uid="uid://cst66y2l1p0lc" path="res://scripts/players/player_states/combat_states/heavy_attack_1.gd" id="15_ruanc"]
[ext_resource type="Script" uid="uid://b6yu7tj6wh46c" path="res://scripts/players/player_components/animation_controller.gd" id="16_rcyug"]
[ext_resource type="Script" uid="uid://bq8y0x7ps1s5v" path="res://scripts/players/player_components/target_manager.gd" id="17_apfk5"]
[ext_resource type="PackedScene" uid="uid://cgg3yuwmr17cn" path="res://components/combat_manager.tscn" id="18_ym3m5"]
[ext_resource type="Script" uid="uid://bkqea6iys40et" path="res://scripts/custom_resources/DamageData.gd" id="19_dpk7h"]
[ext_resource type="PackedScene" uid="uid://hmbguqu4dkyv" path="res://components/hurtbox.tscn" id="21_ataq6"]
[ext_resource type="Script" uid="uid://bhqmmiil3ivhf" path="res://scripts/custom_resources/CombatStats.gd" id="21_dyl2f"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_monrr"]
radius = 8.481934
height = 123.48779

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_kp2rc"]
animation = &"slash_round_low"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_15rro"]
animation = &"roll"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_pbfsw"]
filter_enabled = true
filters = ["../../AudioStreamPlayer3D", "../../CombatStateMachine/Attack1", "../../CombatStateMachine/DownwardSlash", "../../CombatStateMachine/LowSlash", "../../CombatStateMachine/Slash1", "../../SlashAudioPlayer", "Armature/Skeleton3D/BoneAttachment3D/Hitbox:monitorable", "Armature/Skeleton3D/SwordAttachment/Hitbox:monitorable", "Armature/Skeleton3D:mixamorig_Head", "Armature/Skeleton3D:mixamorig_LeftArm", "Armature/Skeleton3D:mixamorig_LeftForeArm", "Armature/Skeleton3D:mixamorig_LeftHand", "Armature/Skeleton3D:mixamorig_LeftHandIndex1", "Armature/Skeleton3D:mixamorig_LeftHandIndex2", "Armature/Skeleton3D:mixamorig_LeftHandIndex3", "Armature/Skeleton3D:mixamorig_LeftHandIndex4", "Armature/Skeleton3D:mixamorig_LeftHandThumb1", "Armature/Skeleton3D:mixamorig_LeftHandThumb2", "Armature/Skeleton3D:mixamorig_LeftHandThumb3", "Armature/Skeleton3D:mixamorig_LeftHandThumb4", "Armature/Skeleton3D:mixamorig_LeftShoulder", "Armature/Skeleton3D:mixamorig_RightArm", "Armature/Skeleton3D:mixamorig_RightForeArm", "Armature/Skeleton3D:mixamorig_RightHand", "Armature/Skeleton3D:mixamorig_RightHandIndex1", "Armature/Skeleton3D:mixamorig_RightHandIndex2", "Armature/Skeleton3D:mixamorig_RightHandIndex3", "Armature/Skeleton3D:mixamorig_RightHandIndex4", "Armature/Skeleton3D:mixamorig_RightHandThumb1", "Armature/Skeleton3D:mixamorig_RightHandThumb2", "Armature/Skeleton3D:mixamorig_RightHandThumb3", "Armature/Skeleton3D:mixamorig_RightHandThumb4", "Armature/Skeleton3D:mixamorig_RightShoulder", "Armature/Skeleton3D:mixamorig_Spine", "Armature/Skeleton3D:mixamorig_Spine1", "Armature/Skeleton3D:mixamorig_Spine2", "Maria Model/Skeleton3D/BoneAttachment3D/Hitbox:monitorable", "Maria Model/Skeleton3D:mixamorig_LeftArm", "Maria Model/Skeleton3D:mixamorig_LeftForeArm", "Maria Model/Skeleton3D:mixamorig_LeftHand", "Maria Model/Skeleton3D:mixamorig_LeftHandIndex1", "Maria Model/Skeleton3D:mixamorig_LeftHandIndex2", "Maria Model/Skeleton3D:mixamorig_LeftHandIndex3", "Maria Model/Skeleton3D:mixamorig_LeftHandIndex4", "Maria Model/Skeleton3D:mixamorig_LeftHandMiddle1", "Maria Model/Skeleton3D:mixamorig_LeftHandMiddle2", "Maria Model/Skeleton3D:mixamorig_LeftHandMiddle3", "Maria Model/Skeleton3D:mixamorig_LeftHandMiddle4", "Maria Model/Skeleton3D:mixamorig_LeftHandPinky1", "Maria Model/Skeleton3D:mixamorig_LeftHandPinky2", "Maria Model/Skeleton3D:mixamorig_LeftHandPinky3", "Maria Model/Skeleton3D:mixamorig_LeftHandPinky4", "Maria Model/Skeleton3D:mixamorig_LeftHandRing1", "Maria Model/Skeleton3D:mixamorig_LeftHandRing2", "Maria Model/Skeleton3D:mixamorig_LeftHandRing3", "Maria Model/Skeleton3D:mixamorig_LeftHandRing4", "Maria Model/Skeleton3D:mixamorig_LeftHandThumb1", "Maria Model/Skeleton3D:mixamorig_LeftHandThumb2", "Maria Model/Skeleton3D:mixamorig_LeftHandThumb3", "Maria Model/Skeleton3D:mixamorig_LeftHandThumb4", "Maria Model/Skeleton3D:mixamorig_LeftShoulder", "Maria Model/Skeleton3D:mixamorig_Neck", "Maria Model/Skeleton3D:mixamorig_RightArm", "Maria Model/Skeleton3D:mixamorig_RightForeArm", "Maria Model/Skeleton3D:mixamorig_RightHand", "Maria Model/Skeleton3D:mixamorig_RightHandIndex1", "Maria Model/Skeleton3D:mixamorig_RightHandIndex2", "Maria Model/Skeleton3D:mixamorig_RightHandIndex3", "Maria Model/Skeleton3D:mixamorig_RightHandIndex4", "Maria Model/Skeleton3D:mixamorig_RightHandMiddle1", "Maria Model/Skeleton3D:mixamorig_RightHandMiddle2", "Maria Model/Skeleton3D:mixamorig_RightHandMiddle3", "Maria Model/Skeleton3D:mixamorig_RightHandMiddle4", "Maria Model/Skeleton3D:mixamorig_RightHandPinky1", "Maria Model/Skeleton3D:mixamorig_RightHandPinky2", "Maria Model/Skeleton3D:mixamorig_RightHandPinky3", "Maria Model/Skeleton3D:mixamorig_RightHandPinky4", "Maria Model/Skeleton3D:mixamorig_RightHandRing1", "Maria Model/Skeleton3D:mixamorig_RightHandRing2", "Maria Model/Skeleton3D:mixamorig_RightHandRing3", "Maria Model/Skeleton3D:mixamorig_RightHandRing4", "Maria Model/Skeleton3D:mixamorig_RightHandThumb1", "Maria Model/Skeleton3D:mixamorig_RightHandThumb2", "Maria Model/Skeleton3D:mixamorig_RightHandThumb3", "Maria Model/Skeleton3D:mixamorig_RightHandThumb4", "Maria Model/Skeleton3D:mixamorig_RightShoulder", "Maria Model/Skeleton3D:mixamorig_Spine", "Maria Model/Skeleton3D:mixamorig_Spine1", "Maria Model/Skeleton3D:mixamorig_Spine2"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_qtqh7"]
animation = &"slash_1"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2wuci"]
animation = &"slash_2"
advance_on_start = true

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_1lk21"]
animation = &"slash_round_low"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_634y6"]
advance_mode = 2
advance_expression = "combat_state_machine.current_state.name == \"Slash1\""

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7lmhl"]
switch_mode = 2
advance_mode = 2
advance_expression = "combat_state_machine.current_state.name == \"NotAttacking\""

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_efrwb"]
switch_mode = 2
advance_mode = 2
advance_expression = "combat_state_machine.current_state.name == \"Slash2\""

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_dx0e4"]
switch_mode = 2
advance_mode = 2
advance_expression = "combat_state_machine.current_state.name == \"NotAttacking\""

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_kp2rc"]
advance_mode = 2
advance_expression = "combat_state_machine.current_state.name == \"Slash3\""

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_cntur"]
advance_mode = 2
advance_expression = "combat_state_machine.current_state.name == \"NotAttacking\""

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_b88wv"]
states/End/position = Vector2(1071, 110)
states/Start/position = Vector2(311, 117)
states/slash_1/node = SubResource("AnimationNodeAnimation_qtqh7")
states/slash_1/position = Vector2(605, 41)
states/slash_2/node = SubResource("AnimationNodeAnimation_2wuci")
states/slash_2/position = Vector2(605, 158)
states/slash_round_low/node = SubResource("AnimationNodeAnimation_1lk21")
states/slash_round_low/position = Vector2(605, 261)
transitions = ["Start", "slash_1", SubResource("AnimationNodeStateMachineTransition_634y6"), "slash_1", "End", SubResource("AnimationNodeStateMachineTransition_7lmhl"), "slash_1", "slash_2", SubResource("AnimationNodeStateMachineTransition_efrwb"), "slash_2", "End", SubResource("AnimationNodeStateMachineTransition_dx0e4"), "Start", "slash_round_low", SubResource("AnimationNodeStateMachineTransition_kp2rc"), "slash_round_low", "End", SubResource("AnimationNodeStateMachineTransition_cntur")]
graph_offset = Vector2(128, 126)

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_1lk21"]

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_cntur"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_pbfsw"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_iruf7"]
animation = &"falling_idle"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_j5n4i"]
filter_enabled = true
filters = ["Maria Model/Skeleton3D:mixamorig_LeftArm", "Maria Model/Skeleton3D:mixamorig_LeftForeArm", "Maria Model/Skeleton3D:mixamorig_LeftHand", "Maria Model/Skeleton3D:mixamorig_LeftHandIndex1", "Maria Model/Skeleton3D:mixamorig_LeftHandIndex2", "Maria Model/Skeleton3D:mixamorig_LeftHandIndex3", "Maria Model/Skeleton3D:mixamorig_LeftHandIndex4", "Maria Model/Skeleton3D:mixamorig_LeftHandMiddle1", "Maria Model/Skeleton3D:mixamorig_LeftHandMiddle2", "Maria Model/Skeleton3D:mixamorig_LeftHandMiddle3", "Maria Model/Skeleton3D:mixamorig_LeftHandMiddle4", "Maria Model/Skeleton3D:mixamorig_LeftHandPinky1", "Maria Model/Skeleton3D:mixamorig_LeftHandPinky2", "Maria Model/Skeleton3D:mixamorig_LeftHandPinky3", "Maria Model/Skeleton3D:mixamorig_LeftHandPinky4", "Maria Model/Skeleton3D:mixamorig_LeftHandRing1", "Maria Model/Skeleton3D:mixamorig_LeftHandRing2", "Maria Model/Skeleton3D:mixamorig_LeftHandRing3", "Maria Model/Skeleton3D:mixamorig_LeftHandRing4", "Maria Model/Skeleton3D:mixamorig_LeftHandThumb1", "Maria Model/Skeleton3D:mixamorig_LeftHandThumb2", "Maria Model/Skeleton3D:mixamorig_LeftHandThumb3", "Maria Model/Skeleton3D:mixamorig_LeftHandThumb4", "Maria Model/Skeleton3D:mixamorig_LeftShoulder", "Maria Model/Skeleton3D:mixamorig_RightArm", "Maria Model/Skeleton3D:mixamorig_RightForeArm", "Maria Model/Skeleton3D:mixamorig_RightHand", "Maria Model/Skeleton3D:mixamorig_RightHandIndex1", "Maria Model/Skeleton3D:mixamorig_RightHandIndex2", "Maria Model/Skeleton3D:mixamorig_RightHandIndex3", "Maria Model/Skeleton3D:mixamorig_RightHandIndex4", "Maria Model/Skeleton3D:mixamorig_RightHandMiddle1", "Maria Model/Skeleton3D:mixamorig_RightHandMiddle2", "Maria Model/Skeleton3D:mixamorig_RightHandMiddle3", "Maria Model/Skeleton3D:mixamorig_RightHandMiddle4", "Maria Model/Skeleton3D:mixamorig_RightHandPinky1", "Maria Model/Skeleton3D:mixamorig_RightHandPinky2", "Maria Model/Skeleton3D:mixamorig_RightHandPinky3", "Maria Model/Skeleton3D:mixamorig_RightHandPinky4", "Maria Model/Skeleton3D:mixamorig_RightHandRing1", "Maria Model/Skeleton3D:mixamorig_RightHandRing2", "Maria Model/Skeleton3D:mixamorig_RightHandRing3", "Maria Model/Skeleton3D:mixamorig_RightHandRing4", "Maria Model/Skeleton3D:mixamorig_RightHandThumb1", "Maria Model/Skeleton3D:mixamorig_RightHandThumb2", "Maria Model/Skeleton3D:mixamorig_RightHandThumb3", "Maria Model/Skeleton3D:mixamorig_RightHandThumb4", "Maria Model/Skeleton3D:mixamorig_RightShoulder"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_pbfsw"]
graph_offset = Vector2(325.45654, 65.31828)
nodes/output/position = Vector2(1260, 120)
nodes/Animation/node = SubResource("AnimationNodeAnimation_iruf7")
nodes/Animation/position = Vector2(740, 60)
nodes/Blend2/node = SubResource("AnimationNodeBlend2_j5n4i")
nodes/Blend2/position = Vector2(1000, 100)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_pbfsw")
"nodes/Animation 2/position" = Vector2(740, 240)
node_connections = [&"output", 0, &"Blend2", &"Blend2", 0, &"Animation", &"Blend2", 1, &"Animation 2"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_xdeuw"]
animation = &"walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_38c5k"]
animation = &"run"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_7lmhl"]
blend_point_0/node = SubResource("AnimationNodeAnimation_xdeuw")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_38c5k")
blend_point_1/pos = 1.0
min_space = 0.0
snap = 0.5

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_dx0e4"]
animation = &"jump_forward"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_8g3xg"]
animation = &"walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_monrr"]
animation = &"run"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ulow1"]
animation = &"walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_51p4a"]
animation = &"walk_backwards"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_kolhv"]
animation = &"walk_backwards"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ixvfh"]
animation = &"strafe_right"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_gr1yf"]
animation = &"strafe_run_right"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3lvfj"]
animation = &"strafe_left"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_r05bu"]
animation = &"strafe_run_left"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_gku8k"]
animation = &"walk_backwards"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2sjqy"]
animation = &"run_backwards"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_36l6j"]
animation = &"idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ruanc"]
animation = &"walk"

[sub_resource type="AnimationNodeBlendSpace2D" id="AnimationNodeBlendSpace2D_jm5j8"]
blend_point_0/node = SubResource("AnimationNodeAnimation_8g3xg")
blend_point_0/pos = Vector2(0, 1)
blend_point_1/node = SubResource("AnimationNodeAnimation_monrr")
blend_point_1/pos = Vector2(0, 2)
blend_point_2/node = SubResource("AnimationNodeAnimation_ixvfh")
blend_point_2/pos = Vector2(1, 0)
blend_point_3/node = SubResource("AnimationNodeAnimation_gr1yf")
blend_point_3/pos = Vector2(2, 0)
blend_point_4/node = SubResource("AnimationNodeAnimation_3lvfj")
blend_point_4/pos = Vector2(-1, 0)
blend_point_5/node = SubResource("AnimationNodeAnimation_r05bu")
blend_point_5/pos = Vector2(-2, 0)
blend_point_6/node = SubResource("AnimationNodeAnimation_gku8k")
blend_point_6/pos = Vector2(0, -1)
blend_point_7/node = SubResource("AnimationNodeAnimation_2sjqy")
blend_point_7/pos = Vector2(0, -2)
blend_point_8/node = SubResource("AnimationNodeAnimation_36l6j")
blend_point_8/pos = Vector2(0, 0)
blend_point_9/node = SubResource("AnimationNodeAnimation_ruanc")
blend_point_9/pos = Vector2(0.7, 0.7)
blend_point_10/node = SubResource("AnimationNodeAnimation_ulow1")
blend_point_10/pos = Vector2(-0.7, 0.7)
blend_point_11/node = SubResource("AnimationNodeAnimation_51p4a")
blend_point_11/pos = Vector2(-0.7, -0.7)
blend_point_12/node = SubResource("AnimationNodeAnimation_kolhv")
blend_point_12/pos = Vector2(0.7, -0.7)
min_space = Vector2(-2, -2)
max_space = Vector2(2, 2)
snap = Vector2(0.7, 0.7)

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_7hik5"]
animation = &"idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_j5n4i"]
advance_mode = 2

[sub_resource type="Curve" id="Curve_pbfsw"]
_data = [Vector2(0, 0), 0.0, 1.0, 0, 1, Vector2(1, 1), 1.0, 0.0, 1, 0]
point_count = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_pbfsw"]
xfade_time = 0.15
xfade_curve = SubResource("Curve_pbfsw")
break_loop_at_end = true
advance_mode = 2
advance_expression = "input_dir.length() != 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_5tmop"]
xfade_time = 0.15
break_loop_at_end = true
advance_mode = 2
advance_expression = "input_dir.length() == 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ek41f"]
xfade_time = 0.1
advance_mode = 2
advance_expression = "is_target_locked"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7ahtn"]
advance_mode = 2
advance_expression = "not is_target_locked"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_jm5j8"]
xfade_time = 0.1
advance_mode = 2
advance_expression = "velocity.y > 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_hiqhm"]
xfade_time = 0.1
advance_mode = 2
advance_expression = "velocity.y > 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_tkwlq"]
xfade_time = 0.1
advance_mode = 2
advance_expression = "velocity.y > 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7hik5"]
advance_mode = 2
advance_expression = "velocity.y < 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_qtqh7"]
xfade_time = 0.1
advance_mode = 2
advance_expression = "velocity.y < 0"

[sub_resource type="Curve" id="Curve_7ahtn"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_2wuci"]
xfade_time = 0.2
xfade_curve = SubResource("Curve_7ahtn")
switch_mode = 2
advance_mode = 2
advance_expression = "is_on_floor()"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_iruf7"]
advance_mode = 2
advance_expression = "is_on_floor()"

[sub_resource type="Curve" id="Curve_5tmop"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(1, 1), 1.4, 0.0, 0, 0]
point_count = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_hl5qd"]
xfade_time = 0.2
xfade_curve = SubResource("Curve_5tmop")
advance_mode = 2
advance_expression = "velocity.y < 0"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_khis8"]
advance_mode = 2
advance_expression = "velocity.y < 0"

[sub_resource type="Curve" id="Curve_7lmhl"]
_data = [Vector2(0, 0), 0.0, 1.4, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_b88wv"]
xfade_time = 0.2
xfade_curve = SubResource("Curve_7lmhl")
advance_mode = 2
advance_expression = "is_on_floor()"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_7lmhl"]
states/End/position = Vector2(1107, 92)
states/Falling/node = SubResource("AnimationNodeBlendTree_pbfsw")
states/Falling/position = Vector2(449, 214)
states/FreeLocomotion/node = SubResource("AnimationNodeBlendSpace1D_7lmhl")
states/FreeLocomotion/position = Vector2(449, 92)
states/JumpRaise/node = SubResource("AnimationNodeAnimation_dx0e4")
states/JumpRaise/position = Vector2(521, -38)
states/Start/position = Vector2(79, 92)
states/TargetedLocomotion/node = SubResource("AnimationNodeBlendSpace2D_jm5j8")
states/TargetedLocomotion/position = Vector2(678, 92)
states/idle/node = SubResource("AnimationNodeAnimation_7hik5")
states/idle/position = Vector2(245, 92)
transitions = ["Start", "idle", SubResource("AnimationNodeStateMachineTransition_j5n4i"), "idle", "FreeLocomotion", SubResource("AnimationNodeStateMachineTransition_pbfsw"), "FreeLocomotion", "idle", SubResource("AnimationNodeStateMachineTransition_5tmop"), "FreeLocomotion", "TargetedLocomotion", SubResource("AnimationNodeStateMachineTransition_ek41f"), "TargetedLocomotion", "FreeLocomotion", SubResource("AnimationNodeStateMachineTransition_7ahtn"), "TargetedLocomotion", "JumpRaise", SubResource("AnimationNodeStateMachineTransition_jm5j8"), "idle", "JumpRaise", SubResource("AnimationNodeStateMachineTransition_hiqhm"), "FreeLocomotion", "JumpRaise", SubResource("AnimationNodeStateMachineTransition_tkwlq"), "FreeLocomotion", "Falling", SubResource("AnimationNodeStateMachineTransition_7hik5"), "TargetedLocomotion", "Falling", SubResource("AnimationNodeStateMachineTransition_qtqh7"), "Falling", "FreeLocomotion", SubResource("AnimationNodeStateMachineTransition_2wuci"), "Falling", "TargetedLocomotion", SubResource("AnimationNodeStateMachineTransition_iruf7"), "JumpRaise", "Falling", SubResource("AnimationNodeStateMachineTransition_hl5qd"), "idle", "Falling", SubResource("AnimationNodeStateMachineTransition_khis8"), "Falling", "idle", SubResource("AnimationNodeStateMachineTransition_b88wv")]
graph_offset = Vector2(7.2827454, -15)

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_38c5k"]
graph_offset = Vector2(-527.432, 17.872269)
nodes/output/position = Vector2(740, 300)
nodes/Locomotion/node = SubResource("AnimationNodeStateMachine_7lmhl")
nodes/Locomotion/position = Vector2(-620, 100)
nodes/Combat/node = SubResource("AnimationNodeStateMachine_b88wv")
nodes/Combat/position = Vector2(-620, 340)
nodes/Blend2/node = SubResource("AnimationNodeBlend2_pbfsw")
nodes/Blend2/position = Vector2(-280, 160)
nodes/EvadeOneShot/node = SubResource("AnimationNodeOneShot_1lk21")
nodes/EvadeOneShot/position = Vector2(420, 240)
nodes/Animation/node = SubResource("AnimationNodeAnimation_15rro")
nodes/Animation/position = Vector2(200, 500)
nodes/HeavyAttackOneShot/node = SubResource("AnimationNodeOneShot_cntur")
nodes/HeavyAttackOneShot/position = Vector2(0, 220)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_kp2rc")
"nodes/Animation 2/position" = Vector2(-260, 460)
node_connections = [&"output", 0, &"EvadeOneShot", &"Blend2", 0, &"Locomotion", &"Blend2", 1, &"Combat", &"EvadeOneShot", 0, &"HeavyAttackOneShot", &"EvadeOneShot", 1, &"Animation", &"HeavyAttackOneShot", 0, &"Blend2", &"HeavyAttackOneShot", 1, &"Animation 2"]

[sub_resource type="Resource" id="Resource_1lk21"]
script = ExtResource("19_dpk7h")
damage_value = 21.0
metadata/_custom_type_script = "uid://bkqea6iys40et"

[sub_resource type="Resource" id="Resource_kp2rc"]
script = ExtResource("19_dpk7h")
damage_value = 42.0
metadata/_custom_type_script = "uid://bkqea6iys40et"

[sub_resource type="Resource" id="Resource_15rro"]
script = ExtResource("21_dyl2f")
health = 100.0
stamina = 100.0
armor = 10.0
metadata/_custom_type_script = "uid://bhqmmiil3ivhf"

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_pjw5s"]
height = 1.9484863

[sub_resource type="SphereShape3D" id="SphereShape3D_15rro"]
radius = 10.0

[node name="CastleGuard" type="CharacterBody3D"]
collision_layer = 2
script = ExtResource("1_xdeuw")

[node name="Visuals" type="Node3D" parent="."]

[node name="castle_guard_rig" parent="Visuals" instance=ExtResource("3_eenxj")]

[node name="Skeleton3D" parent="Visuals/castle_guard_rig/Armature" index="0"]
bones/0/position = Vector3(1.4881071, -1.5238107, -83.565475)
bones/0/rotation = Quaternion(-0.56050235, -0.29978526, 0.3501839, 0.687995)
bones/1/rotation = Quaternion(-0.04748597, -0.017189661, 0.015240777, 0.9986077)
bones/2/rotation = Quaternion(0.0076589696, -0.0067009935, -0.010685279, 0.99989116)
bones/3/position = Vector3(4.129776e-07, 10.089547, -4.9201235e-06)
bones/3/rotation = Quaternion(-0.01814097, -0.006149125, -0.0047273003, 0.99980533)
bones/4/position = Vector3(1.3147178e-05, 26.668526, -1.2067342)
bones/4/rotation = Quaternion(-0.01611886, 0.086772196, -0.016458005, 0.99596184)
bones/5/rotation = Quaternion(0.027527919, -0.10966946, 0.024926407, 0.99327415)
bones/9/position = Vector3(14.211849, 23.227427, -1.2685592)
bones/9/rotation = Quaternion(-0.57547194, -0.3999757, 0.62337327, -0.34678146)
bones/10/position = Vector3(1.7327548e-06, 11.940496, 1.1505461e-05)
bones/10/rotation = Quaternion(-0.449198, -0.033746593, -0.0719019, 0.88989466)
bones/11/position = Vector3(7.759256e-07, 32.327625, -1.791542e-05)
bones/11/rotation = Quaternion(-0.091637895, 0.11773084, -0.37957227, 0.9130537)
bones/12/position = Vector3(0.00018214447, 31.834734, -2.225506e-05)
bones/12/rotation = Quaternion(-0.0207493, -0.00031118374, -0.02283314, 0.9995239)
bones/13/position = Vector3(-7.4035754, 10.426602, 3.7019558)
bones/13/rotation = Quaternion(0.17958826, -0.06509432, 0.23012571, 0.95422906)
bones/14/position = Vector3(1.073676e-05, 5.049834, 4.4703393e-06)
bones/14/rotation = Quaternion(0.025454361, -0.057936076, 0.084321514, 0.9944272)
bones/15/position = Vector3(-3.0982505e-05, 5.7971964, 0.000100432335)
bones/15/rotation = Quaternion(-0.12358626, -0.24194323, 0.104878016, 0.9566559)
bones/16/position = Vector3(4.8692204e-05, 4.4128675, -9.182592e-05)
bones/17/position = Vector3(-0.0001099507, 22.748356, -0.15910213)
bones/17/rotation = Quaternion(-0.36997473, -0.011850586, -0.040873118, 0.9280667)
bones/18/position = Vector3(-7.194406e-06, 5.1461697, -4.4339424e-05)
bones/18/rotation = Quaternion(-0.30572367, -0.0117303375, -0.017749816, 0.95188254)
bones/19/position = Vector3(1.5171883e-06, 5.1074862, -1.0716077e-05)
bones/19/rotation = Quaternion(-0.31790888, -0.00549225, 0.007844143, 0.948073)
bones/20/position = Vector3(7.342083e-06, 3.1996202, -3.2370946e-05)
bones/21/position = Vector3(-14.211806, 23.227427, -1.268559)
bones/21/rotation = Quaternion(0.6628163, -0.36249295, 0.5320031, 0.3824215)
bones/22/position = Vector3(9.052315e-07, 11.940518, -1.8039336e-05)
bones/22/rotation = Quaternion(-0.4903873, 0.0061324323, 0.013992726, 0.8713708)
bones/23/position = Vector3(5.8487853e-07, 32.327583, 3.6968459e-07)
bones/23/rotation = Quaternion(-0.00042707982, -0.0035092705, 0.29158205, 0.95653933)
bones/24/position = Vector3(-7.588293e-05, 32.168888, 1.0444672e-05)
bones/24/rotation = Quaternion(-0.06518463, -0.0010337221, 0.1414414, 0.9877977)
bones/25/position = Vector3(4.772997, 10.394037, 3.7880917)
bones/25/rotation = Quaternion(0.12438637, 0.08033156, -0.36351523, 0.91974545)
bones/26/position = Vector3(4.6729965e-06, 5.770433, 1.1447575e-05)
bones/26/rotation = Quaternion(0.048080437, 0.0833934, 0.020817818, 0.9951384)
bones/27/position = Vector3(1.5576761e-06, 6.1464543, -2.5344361e-05)
bones/27/rotation = Quaternion(0.08580978, -0.07280896, -0.050865337, 0.9923449)
bones/28/position = Vector3(5.6062654e-05, 4.412907, 5.807369e-07)
bones/29/position = Vector3(0.00010368253, 21.10296, -0.14584944)
bones/29/rotation = Quaternion(-0.2813525, -0.00856523, -0.011252509, 0.9595004)
bones/30/position = Vector3(5.5546557e-06, 5.7418, 6.4649103e-06)
bones/30/rotation = Quaternion(-0.30610222, 0.011772442, 0.017750487, 0.9517604)
bones/31/position = Vector3(1.8711387e-05, 5.0318675, 7.0025067e-06)
bones/31/rotation = Quaternion(-0.27314177, 0.0069895526, -0.006383728, 0.9619273)
bones/32/position = Vector3(-2.3536315e-05, 5.4053955, -7.797352e-06)
bones/33/rotation = Quaternion(0.3579516, 0.4971289, 0.76146656, -0.21190149)
bones/34/position = Vector3(-3.6108577e-07, 35.90404, 6.358791e-06)
bones/34/rotation = Quaternion(-0.46795696, 0.1355167, -0.010206213, 0.8732396)
bones/35/position = Vector3(-9.8089345e-08, 40.577435, 1.9183351e-05)
bones/35/rotation = Quaternion(0.3907652, -0.027604245, -0.060830187, 0.9180634)
bones/36/rotation = Quaternion(0.42795506, 0.0027022294, -0.01763933, 0.9036239)
bones/38/rotation = Quaternion(-0.23799716, 0.26192257, 0.89594865, 0.26838398)
bones/39/position = Vector3(1.0951176e-05, 35.904064, -1.9764913e-05)
bones/39/rotation = Quaternion(-0.41343838, -0.015465062, -0.042989343, 0.9093852)
bones/40/position = Vector3(-3.856931e-06, 40.577393, 6.2312015e-06)
bones/40/rotation = Quaternion(0.49689874, 0.101017736, 0.23514208, 0.8292137)
bones/41/rotation = Quaternion(0.40941197, 0.025587784, 0.015787156, 0.91185415)

[node name="SwordAttachment" type="BoneAttachment3D" parent="Visuals/castle_guard_rig/Armature/Skeleton3D" index="1"]
transform = Transform3D(-0.94034994, 0.23842007, -0.24268898, -0.043822546, -0.79229677, -0.6085605, -0.33737466, -0.5616244, 0.75548434, -37.802948, -64.625984, -171.5237)
bone_name = "mixamorig_RightHand"
bone_idx = 24

[node name="Sword00_mesh" parent="Visuals/castle_guard_rig/Armature/Skeleton3D/SwordAttachment" instance=ExtResource("4_pjw5s")]
transform = Transform3D(-48.725826, 396.79913, 13.2803955, 244.11487, 40.494545, -314.27396, -313.10355, -30.178436, -247.09406, -14.850088, 16.338514, 5.5537877)

[node name="Hitbox" parent="Visuals/castle_guard_rig/Armature/Skeleton3D/SwordAttachment" instance=ExtResource("4_8g3xg")]
transform = Transform3D(0.15399209, 0.9878942, 0.018739492, -0.83478975, 0.11993319, 0.53734714, 0.5285948, -0.0983904, 0.843153, 44.87023, 18.957548, 1.3657761)
monitorable = false

[node name="CollisionShape3D" parent="Visuals/castle_guard_rig/Armature/Skeleton3D/SwordAttachment/Hitbox" index="0"]
transform = Transform3D(0.99999976, 4.4703484e-08, 1.7881393e-07, -7.4505806e-08, 1.0000008, -1.7881393e-07, -1.013279e-06, 1.937151e-06, 0.9999978, 0.5108566, 30.176712, -0.0015945435)
shape = SubResource("CapsuleShape3D_monrr")

[node name="ShieldAttachment" type="BoneAttachment3D" parent="Visuals/castle_guard_rig/Armature/Skeleton3D" index="2"]
transform = Transform3D(-0.014186095, 0.81472254, 0.579677, -0.9859304, -0.10796332, 0.12761171, 0.16655208, -0.569711, 0.80479157, 31.912079, 43.304916, -150.32712)
bone_name = "mixamorig_LeftForeArm"
bone_idx = 11

[node name="Shield00_mesh" parent="Visuals/castle_guard_rig/Armature/Skeleton3D/ShieldAttachment" instance=ExtResource("7_8g3xg")]
transform = Transform3D(13.410723, 199.54858, -0.74030113, -66.547455, 5.1718006, 188.53297, 188.1266, -12.395504, 66.744064, -37.845604, 41.922527, -6.0147667)

[node name="AnimationTree" type="AnimationTree" parent="." node_paths=PackedStringArray("player")]
unique_name_in_owner = true
root_node = NodePath("%AnimationTree/../Visuals/castle_guard_rig")
tree_root = SubResource("AnimationNodeBlendTree_38c5k")
advance_expression_base_node = NodePath("..")
anim_player = NodePath("../Visuals/castle_guard_rig/AnimationPlayer")
parameters/Locomotion/Falling/Blend2/blend_amount = 0.5
parameters/Locomotion/FreeLocomotion/blend_position = 0.4257576
parameters/Locomotion/TargetedLocomotion/blend_position = Vector2(0.029173374, 1.3859649)
parameters/Blend2/blend_amount = 1.5333333
parameters/EvadeOneShot/active = false
parameters/EvadeOneShot/internal_active = false
parameters/EvadeOneShot/request = 0
parameters/HeavyAttackOneShot/active = false
parameters/HeavyAttackOneShot/internal_active = false
parameters/HeavyAttackOneShot/request = 0
script = ExtResource("16_rcyug")
player = NodePath("..")

[node name="SpringArm3D" type="SpringArm3D" parent="." node_paths=PackedStringArray("player")]
top_level = true
spring_length = 4.0
script = ExtResource("2_38c5k")
player = NodePath("..")
camera_smoothing = 20.0

[node name="Camera3D" type="Camera3D" parent="SpringArm3D"]
current = true
fov = 70.0
script = ExtResource("3_8g3xg")

[node name="LocomotionStateMachine" type="Node" parent="." node_paths=PackedStringArray("initial_state")]
script = ExtResource("6_gr1yf")
initial_state = NodePath("Walk")

[node name="Walk" type="Node" parent="LocomotionStateMachine" node_paths=PackedStringArray("player")]
script = ExtResource("7_3lvfj")
idle_state_path = NodePath("../Idle")
sprint_state_path = NodePath("../Sprint")
jump_state_path = NodePath("../Jump")
fall_state_path = NodePath("../Fall")
evade_state_path = NodePath("../Evade")
player = NodePath("../..")

[node name="Sprint" type="Node" parent="LocomotionStateMachine" node_paths=PackedStringArray("player")]
script = ExtResource("8_r05bu")
idle_state_path = NodePath("../Idle")
walk_state_path = NodePath("../Walk")
jump_state_path = NodePath("../Jump")
evade_state_path = NodePath("../Evade")
free_speed = 3.2
target_locked_speed = 2.75
player = NodePath("../..")

[node name="Idle" type="Node" parent="LocomotionStateMachine" node_paths=PackedStringArray("player")]
script = ExtResource("9_gku8k")
walk_state_path = NodePath("../Walk")
jump_state_path = NodePath("../Jump")
sprint_state_path = NodePath("../Sprint")
fall_state_path = NodePath("../Fall")
player = NodePath("../..")

[node name="Jump" type="Node" parent="LocomotionStateMachine" node_paths=PackedStringArray("player")]
script = ExtResource("10_2sjqy")
fall_state_path = NodePath("../Fall")
idle_state_path = NodePath("../Idle")
free_speed = 2.0
target_locked_speed = 2.0
player = NodePath("../..")

[node name="Fall" type="Node" parent="LocomotionStateMachine" node_paths=PackedStringArray("player")]
script = ExtResource("11_36l6j")
idle_state_path = NodePath("../Idle")
sprint_state_path = NodePath("../Sprint")
free_speed = 2.0
target_locked_speed = 2.0
player = NodePath("../..")

[node name="Evade" type="Node" parent="LocomotionStateMachine" node_paths=PackedStringArray("player")]
script = ExtResource("15_15rro")
idle_state_path = NodePath("../Idle")
walk_state_path = NodePath("../Walk")
sprint_state_path = NodePath("../Sprint")
free_speed = 3.2
target_locked_speed = 3.2
player = NodePath("../..")

[node name="CombatStateMachine" type="Node" parent="." node_paths=PackedStringArray("initial_state")]
script = ExtResource("6_gr1yf")
initial_state = NodePath("NotAttacking")
metadata/_custom_type_script = "uid://ldf4sgx7md2t"

[node name="NotAttacking" type="Node" parent="CombatStateMachine" node_paths=PackedStringArray("player")]
script = ExtResource("12_ulow1")
attack1_state_path = NodePath("../Attack1")
heavy_attack1_state_path = NodePath("../HeavyAttack1")
player = NodePath("../..")

[node name="Attack1" type="Node" parent="CombatStateMachine" node_paths=PackedStringArray("hitbox", "player")]
script = ExtResource("13_51p4a")
attack_2_state_path = NodePath("../Attack2")
not_attacking_state_path = NodePath("../NotAttacking")
hitbox = NodePath("../../Visuals/castle_guard_rig/Armature/Skeleton3D/SwordAttachment/Hitbox")
damage_data = SubResource("Resource_1lk21")
animation_name = "slash_1"
player = NodePath("../..")

[node name="Attack2" type="Node" parent="CombatStateMachine" node_paths=PackedStringArray("hitbox", "player")]
script = ExtResource("14_kolhv")
not_attacking_state_path = NodePath("../NotAttacking")
hitbox = NodePath("../../Visuals/castle_guard_rig/Armature/Skeleton3D/SwordAttachment/Hitbox")
damage_data = SubResource("Resource_1lk21")
animation_name = "slash_2"
player = NodePath("../..")

[node name="HeavyAttack1" type="Node" parent="CombatStateMachine" node_paths=PackedStringArray("hitbox", "player")]
script = ExtResource("15_ruanc")
not_attacking_state_path = NodePath("../NotAttacking")
hitbox = NodePath("../../Visuals/castle_guard_rig/Armature/Skeleton3D/SwordAttachment/Hitbox")
damage_data = SubResource("Resource_kp2rc")
stamina_cost = 40.0
animation_name = "slash_round_low"
travel_to_anim_name = false
player = NodePath("../..")

[node name="CombatManager" parent="." node_paths=PackedStringArray("hurtbox", "hitbox") instance=ExtResource("18_ym3m5")]
unique_name_in_owner = true
combat_stats = SubResource("Resource_15rro")
hurtbox = NodePath("../Hurtbox")
hitbox = NodePath("../Visuals/castle_guard_rig/Armature/Skeleton3D/SwordAttachment/Hitbox")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.97424316, 0)
shape = SubResource("CapsuleShape3D_pjw5s")

[node name="TargetManager" type="Area3D" parent="." node_paths=PackedStringArray("player")]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
script = ExtResource("17_apfk5")
player = NodePath("..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="TargetManager"]
shape = SubResource("SphereShape3D_15rro")

[node name="Hurtbox" parent="." instance=ExtResource("21_ataq6")]

[node name="SlashAudioPlayer" type="AudioStreamPlayer3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.3243475, 0)

[connection signal="animation_finished" from="Visuals/castle_guard_rig/AnimationPlayer" to="LocomotionStateMachine/Evade" method="_on_animation_player_animation_finished"]
[connection signal="struck" from="CombatManager" to="SpringArm3D/Camera3D" method="_on_combat_manager_struck"]
[connection signal="body_entered" from="TargetManager" to="TargetManager" method="_on_body_entered"]
[connection signal="body_exited" from="TargetManager" to="TargetManager" method="_on_body_exited"]

[editable path="Visuals/castle_guard_rig"]
[editable path="Visuals/castle_guard_rig/Armature/Skeleton3D/SwordAttachment/Hitbox"]
